<!DOCTYPE html>
<html lang="">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.8.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"caixiaobai.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.json"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="KeepUp&#39;s Blog">
<meta property="og:url" content="https://caixiaobai.github.io/page/3/index.html">
<meta property="og:site_name" content="KeepUp&#39;s Blog">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="KeepUp&#39;s Blog">

<link rel="canonical" href="https://caixiaobai.github.io/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'default'
  };
</script>

  <title>KeepUp's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">KeepUp's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="default">
    <link itemprop="mainEntityOfPage" href="https://caixiaobai.github.io/2019/01/21/朴素贝叶斯算法-应用实例/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KeepUp">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KeepUp's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/01/21/朴素贝叶斯算法-应用实例/" class="post-title-link" itemprop="url">朴素贝叶斯算法&应用实例</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-01-21 20:50:46" itemprop="dateCreated datePublished" datetime="2019-01-21T20:50:46+08:00">2019-01-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-11-16 15:09:48" itemprop="dateModified" datetime="2019-11-16T15:09:48+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/机器学习/" itemprop="url" rel="index"><span itemprop="name">机器学习</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="朴素贝叶斯"><a href="#朴素贝叶斯" class="headerlink" title="朴素贝叶斯"></a>朴素贝叶斯</h4><p>朴素贝叶斯中的朴素是指假设各个特征之间相互独立，不会互相影响，所以称为朴素贝叶斯。正是因为这个假设，使得算法的模型简单且容易理解，虽然牺牲了一点准确性，但是如果模型训练的好，也能得到不错的分类效果。</p>
<p><strong>朴素贝叶斯公式：</strong></p>
<script type="math/tex; mode=display">
P(y_i,X)=\frac{P(X,y_i)P(y_i)}{P(X)}=\frac{Py_i\prod P(x_i,y_i)}{P(X)}</script><p>​    $P(X)$ 表示待分类自身的概率，其结果是一个常数，对结果不会造成影响，可忽略</p>
<p>​    $P(y_i)$ 表示每个类别的先验概率，即 $y_i$ 的概率</p>
<p>​    $P(y_i,X)$ 表示给定 $X$ 属于 $y_i$ 类别的概率</p>
<p>​    $P(X,y_i)$ 表示某个类别 $y_i$ 产生 $X$ 的概率</p>
<p>​    $P(x_i,y_i)$ 表示某个类别 $y_i$ 产生某个特征 $x_i$ 的概率</p>
<h4 id="公式简单推导"><a href="#公式简单推导" class="headerlink" title="公式简单推导"></a>公式简单推导</h4><p>下面我们简单看一下公式的推导过程</p>
<p>我们都已知<strong>条件概率公式</strong>（不懂的请先自行了解）</p>
<script type="math/tex; mode=display">
P(A|B)=\frac{P(A,B)}{P(B)}</script><p>然后可以得出 $P(A|B)P(B)=P(A,B)=P(B|A)P(A)$ ，然后我们带入条件概率公式得出 $P(A|B)=\frac{P(B|A)P(A)}{P(B)}$ 然后我们就可以看到它和朴素贝叶斯的前半部分的公式一样了。后边我们只需要推导 $P(X,y_i)=\prod P(x_i,y_i)$ 就可以了，后面的推导我们同个一个简单的例子来加以说明，更容易帮助你理解。因为后边的应用实例是对新闻的分类问题，所以我们这里也举一个简单的新闻分类的例子。</p>
<p>$Y=\{科技，财经，体育，军事\}$ 假设现在新闻只有四个类别，用 $Y$ 表示， $y_i$ 表示其中某一类别，然后假设现在一共有一百篇新闻，并且已知他们各自的类别，科技类的40篇，财经类的30篇，体育类的20篇，军事类的10篇，$P(y_i)$ 表示某一类的先验概率，比如 $P(科技)=\frac{40}{100}=0.4$ ，$X=\{x_{i1},x_{i2} …x_{in}\}$ 表示某一篇文章，$x_i$ 表示该文章的某一个词（即某个事物的属性或者特征），$P(X,y_i)$ 表示对于指定类别 $y_i$ 中出现 $X$ 的概率，这里有点不好理解，其实它就等于 $P(x_i,y_i)$ 对于指定类别 $y_i$ 中出现某个词 $x_i$ 的概率的乘积。比如 「互联网」这个词在科技类的30篇文章中出现过，那么 $P(互联网,科技)=\frac{30}{40}$ ，然后把文章中所有的词对类别的概率相乘就能得到 $P(X,y_i)$ ，当然前提就是我们前边说的那个假设，所有词（特征）之间是相互独立互不影响的。</p>
<h4 id="评测指标"><a href="#评测指标" class="headerlink" title="评测指标"></a>评测指标</h4><p>我们得出分类的结果后，怎么来评测我们训练的模型的好与不好呢？我们通常「准确度」「精确率」「召回率」这几个指标来进行判断模型的好坏。下边我们用一个简单的例子来说明这几个指标是怎么计算的。</p>
<p>下面我们看一个表。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">/</th>
<th style="text-align:center">/</th>
<th style="text-align:center">预测类别</th>
<th style="text-align:center">预测类别</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">/</td>
<td style="text-align:center">/</td>
<td style="text-align:center">科技(35)</td>
<td style="text-align:center">财经(35)</td>
</tr>
<tr>
<td style="text-align:center">实际类别</td>
<td style="text-align:center">科技（40）</td>
<td style="text-align:center">30</td>
<td style="text-align:center">10</td>
</tr>
<tr>
<td style="text-align:center">实际类别</td>
<td style="text-align:center">财经（30）</td>
<td style="text-align:center">5</td>
<td style="text-align:center">25</td>
</tr>
</tbody>
</table>
</div>
<p>表中表示实际上科技类的文章有 40 篇，财经类的有 30 篇，然而预测的结果科技类的有 35 篇，其中 30 篇预测正确了，有 5 篇预测错误了；预测结果财经类的有 35 篇，其中 25 篇预测正确了，10 篇预测错误了。</p>
<ul>
<li>准确度</li>
</ul>
<p>表示预测正确的文章数比上总的文章数：(30+25)/(40+30)=78%</p>
<ul>
<li>精确率</li>
</ul>
<p>表示每一类预测正确的数量比上预测的该类文章总数量，比如科技类精确率：30/(30+5)=85%</p>
<ul>
<li>召回率</li>
</ul>
<p>表示每一类预测正确的数量比上实际该类的总数量，比如科技类：30/40=75%</p>
<h4 id="应用实例"><a href="#应用实例" class="headerlink" title="应用实例"></a>应用实例</h4><p>上边我们已经了解了朴素贝叶斯公式及推导过程，下边我们来看一下在实际的新闻分类中的应用。</p>
<p>元数据的准备，我们的元数据是网上找来的一些各类的新闻，这里为了简单，我们只选取了科技、财经和体育三类数量不等的新闻，并且都已知他们的类别。然后通过<a href="https://github.com/fxsjy/jieba" target="_blank" rel="noopener">中文结巴分词</a></p>
<p>对每篇新闻进行分词。这里我们用到的是gihub上的一个开源的python库，有兴趣的可以了解一下。</p>
<p>下面我们来看一下代码的具体实现。</p>
<p>首先我们先把汉字的文章转成每个词所对应的数字id的形式，方便我们后边的操作和计算。</p>
<p>Convert.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">inputPath = sys.argv[<span class="number">1</span>]</span><br><span class="line">outputFile = sys.argv[<span class="number">2</span>]</span><br><span class="line"><span class="comment">#训练集所占百分比</span></span><br><span class="line">trainPercent = <span class="number">0.8</span></span><br><span class="line">wordDict = &#123;&#125;</span><br><span class="line">wordList = []</span><br><span class="line"></span><br><span class="line">trainOutputFile = open(<span class="string">'%s.train'</span> % outputFile, <span class="string">"w"</span>)</span><br><span class="line">testOutputFile = open(<span class="string">'%s.test'</span> % outputFile, <span class="string">"w"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> fileName <span class="keyword">in</span> os.listdir(inputPath):</span><br><span class="line">    tag = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> fileName.find(<span class="string">'technology'</span>) != <span class="number">-1</span>:</span><br><span class="line">        tag = <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> fileName.find(<span class="string">'business'</span>) != <span class="number">-1</span>:</span><br><span class="line">        tag = <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> fileName.find(<span class="string">'sport'</span>) != <span class="number">-1</span>:</span><br><span class="line">        tag = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">    outFile = trainOutputFile</span><br><span class="line">    rd = random.random()</span><br><span class="line">    <span class="keyword">if</span> rd &gt;= trainPercent:</span><br><span class="line">        outFile = testOutputFile</span><br><span class="line"></span><br><span class="line">    inputFile = open(inputPath+<span class="string">'/'</span>+fileName, <span class="string">"r"</span>)</span><br><span class="line">    content = inputFile.read().strip()</span><br><span class="line">    content = content.decode(<span class="string">'utf-8'</span>, <span class="string">'ignore'</span>)</span><br><span class="line">    content = content.replace(<span class="string">'\n'</span>, <span class="string">' '</span>)</span><br><span class="line">    r1 = <span class="string">u'[a-zA-Z0-9’!"#$%&amp;\'()*+,-./:;&lt;=&gt;?@，。?★、…【】《》？“”‘’！[\\]^_`&#123;|&#125;~]+'</span></span><br><span class="line">    content = re.sub(r1, <span class="string">''</span>, content)</span><br><span class="line">    outFile.write(str(tag)+<span class="string">' '</span>)</span><br><span class="line">    words = content.split(<span class="string">' '</span>)</span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> words:</span><br><span class="line">        <span class="keyword">if</span> word <span class="keyword">not</span> <span class="keyword">in</span> wordDict:</span><br><span class="line">            wordList.append(word)</span><br><span class="line">            wordDict[word] = len(wordList)</span><br><span class="line"></span><br><span class="line">        outFile.write(str(wordDict[word]) + <span class="string">' '</span>)</span><br><span class="line"></span><br><span class="line">    inputFile.close()</span><br><span class="line"></span><br><span class="line">trainOutputFile.close()</span><br><span class="line">testOutputFile.close()</span><br></pre></td></tr></table></figure>
<p>朴素贝叶斯实现过程</p>
<p>NB.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Usage:</span></span><br><span class="line"><span class="comment">#Training: NB.py 1 TrainingDataFile ModelFile</span></span><br><span class="line"><span class="comment">#Testing: NB.py 0 TestDataFile ModelFile OutFile</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DefaultFreq = <span class="number">0.1</span></span><br><span class="line">TrainingDataFile = <span class="string">"nb_data.train"</span></span><br><span class="line">ModelFile = <span class="string">"nb_data.model"</span></span><br><span class="line">TestDataFile = <span class="string">"nb_data.test"</span></span><br><span class="line">TestOutFile = <span class="string">"nb_data.out"</span></span><br><span class="line">ClassFeaDic = &#123;&#125;</span><br><span class="line">ClassFreq = &#123;&#125;</span><br><span class="line">WordDic = &#123;&#125;</span><br><span class="line">ClassFeaProb = &#123;&#125;</span><br><span class="line">ClassDefaultProb = &#123;&#125;</span><br><span class="line">ClassProb = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#加载数据</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">LoadData</span><span class="params">()</span>:</span></span><br><span class="line">    i =<span class="number">0</span></span><br><span class="line">    infile = open(TrainingDataFile, <span class="string">'r'</span>)</span><br><span class="line">    sline = infile.readline().strip()</span><br><span class="line">    <span class="keyword">while</span> len(sline) &gt; <span class="number">0</span>:</span><br><span class="line">        pos = sline.find(<span class="string">"#"</span>)</span><br><span class="line">        <span class="keyword">if</span> pos &gt; <span class="number">0</span>:</span><br><span class="line">            sline = sline[:pos].strip()</span><br><span class="line">        words = sline.split(<span class="string">' '</span>)</span><br><span class="line">        <span class="keyword">if</span> len(words) &lt; <span class="number">1</span>:</span><br><span class="line">            print(<span class="string">"Format error!"</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        classid = int(words[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">if</span> classid <span class="keyword">not</span> <span class="keyword">in</span> ClassFeaDic:</span><br><span class="line">            ClassFeaDic[classid] = &#123;&#125;</span><br><span class="line">            ClassFeaProb[classid] = &#123;&#125;</span><br><span class="line">            ClassFreq[classid]  = <span class="number">0</span></span><br><span class="line">        ClassFreq[classid] += <span class="number">1</span></span><br><span class="line">        words = words[<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> words:</span><br><span class="line">            <span class="keyword">if</span> len(word) &lt; <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            wid = int(word)</span><br><span class="line">            <span class="keyword">if</span> wid <span class="keyword">not</span> <span class="keyword">in</span> WordDic:</span><br><span class="line">                WordDic[wid] = <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> wid <span class="keyword">not</span> <span class="keyword">in</span> ClassFeaDic[classid]:</span><br><span class="line">                ClassFeaDic[classid][wid] = <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                ClassFeaDic[classid][wid] += <span class="number">1</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        sline = infile.readline().strip()</span><br><span class="line">    infile.close()</span><br><span class="line">    print(i, <span class="string">"instances loaded!"</span>)</span><br><span class="line">    print(len(ClassFreq), <span class="string">"classes!"</span>, len(WordDic), <span class="string">"words!"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#计算模型</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ComputeModel</span><span class="params">()</span>:</span></span><br><span class="line">    sum = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">for</span> freq <span class="keyword">in</span> ClassFreq.values():</span><br><span class="line">        sum += freq</span><br><span class="line">    <span class="keyword">for</span> classid <span class="keyword">in</span> ClassFreq.keys():</span><br><span class="line">        ClassProb[classid] = (float)(ClassFreq[classid])/(float)(sum)</span><br><span class="line">    <span class="keyword">for</span> classid <span class="keyword">in</span> ClassFeaDic.keys():</span><br><span class="line">        sum = <span class="number">0.0</span></span><br><span class="line">        <span class="keyword">for</span> wid <span class="keyword">in</span> ClassFeaDic[classid].keys():</span><br><span class="line">            sum += ClassFeaDic[classid][wid]</span><br><span class="line">        newsum = (float)(sum + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> wid <span class="keyword">in</span> ClassFeaDic[classid].keys():</span><br><span class="line">            ClassFeaProb[classid][wid] = (float)(ClassFeaDic[classid][wid]+DefaultFreq)/newsum</span><br><span class="line">        ClassDefaultProb[classid] = (float)(DefaultFreq) / newsum</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#保存模型</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SaveModel</span><span class="params">()</span>:</span></span><br><span class="line">    outfile = open(ModelFile, <span class="string">'w'</span>)</span><br><span class="line">    <span class="keyword">for</span> classid <span class="keyword">in</span> ClassFreq.keys():</span><br><span class="line">        outfile.write(str(classid))</span><br><span class="line">        outfile.write(<span class="string">' '</span>)</span><br><span class="line">        outfile.write(str(ClassProb[classid]))</span><br><span class="line">        outfile.write(<span class="string">' '</span>)</span><br><span class="line">        outfile.write(str(ClassDefaultProb[classid]))</span><br><span class="line">        outfile.write(<span class="string">' '</span> )</span><br><span class="line">    outfile.write(<span class="string">'\n'</span>)</span><br><span class="line">    <span class="keyword">for</span> classid <span class="keyword">in</span> ClassFeaDic.keys():</span><br><span class="line">        <span class="keyword">for</span> wid <span class="keyword">in</span> ClassFeaDic[classid].keys():</span><br><span class="line">            outfile.write(str(wid)+<span class="string">' '</span>+str(ClassFeaProb[classid][wid]))</span><br><span class="line">            outfile.write(<span class="string">' '</span>)</span><br><span class="line">        outfile.write(<span class="string">'\n'</span>)</span><br><span class="line">    outfile.close()</span><br><span class="line"></span><br><span class="line"><span class="comment">#加载模型</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">LoadModel</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> WordDic</span><br><span class="line">    WordDic = &#123;&#125;</span><br><span class="line">    <span class="keyword">global</span> ClassFeaProb</span><br><span class="line">    ClassFeaProb = &#123;&#125;</span><br><span class="line">    <span class="keyword">global</span> ClassDefaultProb</span><br><span class="line">    ClassDefaultProb = &#123;&#125;</span><br><span class="line">    <span class="keyword">global</span> ClassProb</span><br><span class="line">    ClassProb = &#123;&#125;</span><br><span class="line">    infile = open(ModelFile, <span class="string">'r'</span>)</span><br><span class="line">    sline = infile.readline().strip()</span><br><span class="line">    items = sline.split(<span class="string">' '</span>)</span><br><span class="line">    <span class="keyword">if</span> len(items) &lt; <span class="number">6</span>:</span><br><span class="line">        print(<span class="string">"Model format error!"</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i &lt; len(items):</span><br><span class="line">        classid = int(items[i])</span><br><span class="line">        ClassFeaProb[classid] = &#123;&#125;</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> i &gt;= len(items):</span><br><span class="line">            print(<span class="string">"Model format error!"</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        ClassProb[classid] = float(items[i])</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> i &gt;= len(items):</span><br><span class="line">            print(<span class="string">"Model format error!"</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        ClassDefaultProb[classid] = float(items[i])</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> classid <span class="keyword">in</span> ClassProb.keys():</span><br><span class="line">        sline = infile.readline().strip()</span><br><span class="line">        items = sline.split(<span class="string">' '</span>)</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; len(items):</span><br><span class="line">            wid  = int(items[i])</span><br><span class="line">            <span class="keyword">if</span> wid <span class="keyword">not</span> <span class="keyword">in</span> WordDic:</span><br><span class="line">                WordDic[wid] = <span class="number">1</span></span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> i &gt;= len(items):</span><br><span class="line">                print(<span class="string">"Model format error!"</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            ClassFeaProb[classid][wid] = float(items[i])</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">    infile.close()</span><br><span class="line">    print(len(ClassProb), <span class="string">"classes!"</span>, len(WordDic), <span class="string">"words!"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#预测类别</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Predict</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> WordDic</span><br><span class="line">    <span class="keyword">global</span> ClassFeaProb</span><br><span class="line">    <span class="keyword">global</span> ClassDefaultProb</span><br><span class="line">    <span class="keyword">global</span> ClassProb</span><br><span class="line"></span><br><span class="line">    TrueLabelList = []</span><br><span class="line">    PredLabelList = []</span><br><span class="line">    i =<span class="number">0</span></span><br><span class="line">    infile = open(TestDataFile, <span class="string">'r'</span>)</span><br><span class="line">    outfile = open(TestOutFile, <span class="string">'w'</span>)</span><br><span class="line">    sline = infile.readline().strip()</span><br><span class="line">    scoreDic = &#123;&#125;</span><br><span class="line">    iline = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> len(sline) &gt; <span class="number">0</span>:</span><br><span class="line">        iline += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> iline % <span class="number">10</span> == <span class="number">0</span>:</span><br><span class="line">            print(iline,<span class="string">" lines finished!\r"</span>)</span><br><span class="line">        pos = sline.find(<span class="string">"#"</span>)</span><br><span class="line">        <span class="keyword">if</span> pos &gt; <span class="number">0</span>:</span><br><span class="line">            sline = sline[:pos].strip()</span><br><span class="line">        words = sline.split(<span class="string">' '</span>)</span><br><span class="line">        <span class="keyword">if</span> len(words) &lt; <span class="number">1</span>:</span><br><span class="line">            print(<span class="string">"Format error!"</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        classid = int(words[<span class="number">0</span>])</span><br><span class="line">        TrueLabelList.append(classid)</span><br><span class="line">        words = words[<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">for</span> classid <span class="keyword">in</span> ClassProb.keys():</span><br><span class="line">            scoreDic[classid] = math.log(ClassProb[classid])</span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> words:</span><br><span class="line">            <span class="keyword">if</span> len(word) &lt; <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            wid = int(word)</span><br><span class="line">            <span class="keyword">if</span> wid <span class="keyword">not</span> <span class="keyword">in</span> WordDic:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">for</span> classid <span class="keyword">in</span> ClassProb.keys():</span><br><span class="line">                <span class="keyword">if</span> wid <span class="keyword">not</span> <span class="keyword">in</span> ClassFeaProb[classid]:</span><br><span class="line">                    scoreDic[classid] += math.log(ClassDefaultProb[classid])</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    scoreDic[classid] += math.log(ClassFeaProb[classid][wid])</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        maxProb = max(scoreDic.values())</span><br><span class="line">        <span class="keyword">for</span> classid <span class="keyword">in</span> scoreDic.keys():</span><br><span class="line">            <span class="keyword">if</span> scoreDic[classid] == maxProb:</span><br><span class="line">                PredLabelList.append(classid)</span><br><span class="line">        sline = infile.readline().strip()</span><br><span class="line">    infile.close()</span><br><span class="line">    outfile.close()</span><br><span class="line">    print(len(PredLabelList),len(TrueLabelList))</span><br><span class="line">    <span class="keyword">return</span> TrueLabelList,PredLabelList</span><br><span class="line"></span><br><span class="line"><span class="comment">#计算准确度</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Evaluate</span><span class="params">(TrueList, PredList)</span>:</span></span><br><span class="line">    accuracy = <span class="number">0</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i &lt; len(TrueList):</span><br><span class="line">        <span class="keyword">if</span> TrueList[i] == PredList[i]:</span><br><span class="line">            accuracy += <span class="number">1</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    accuracy = (float)(accuracy)/(float)(len(TrueList))</span><br><span class="line">    print(<span class="string">"Accuracy:"</span>,accuracy)</span><br><span class="line"></span><br><span class="line"><span class="comment">#计算精确率和召回率</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CalPreRec</span><span class="params">(TrueList,PredList,classid)</span>:</span></span><br><span class="line">    correctNum = <span class="number">0</span></span><br><span class="line">    allNum = <span class="number">0</span></span><br><span class="line">    predNum = <span class="number">0</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i &lt; len(TrueList):</span><br><span class="line">        <span class="keyword">if</span> TrueList[i] == classid:</span><br><span class="line">            allNum += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> PredList[i] == TrueList[i]:</span><br><span class="line">                correctNum += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> PredList[i] == classid:</span><br><span class="line">            predNum += <span class="number">1</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> (float)(correctNum)/(float)(predNum),(float)(correctNum)/(float)(allNum)</span><br><span class="line"></span><br><span class="line"><span class="comment">#main framework</span></span><br><span class="line"><span class="keyword">if</span> sys.argv[<span class="number">1</span>] == <span class="string">'1'</span>:</span><br><span class="line">    print(<span class="string">"start training:"</span>)</span><br><span class="line">    LoadData()</span><br><span class="line">    ComputeModel()</span><br><span class="line">    SaveModel()</span><br><span class="line"><span class="keyword">elif</span> sys.argv[<span class="number">1</span>] == <span class="string">'0'</span>:</span><br><span class="line">    print(<span class="string">"start testing:"</span>)</span><br><span class="line"></span><br><span class="line">    LoadModel()</span><br><span class="line">    TList,PList = Predict()</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    outfile = open(TestOutFile, <span class="string">'w'</span>)</span><br><span class="line">    <span class="keyword">while</span> i &lt; len(TList):</span><br><span class="line">        outfile.write(str(TList[i]))</span><br><span class="line">        outfile.write(<span class="string">' '</span>)</span><br><span class="line">        outfile.write(str(PList[i]))</span><br><span class="line">        outfile.write(<span class="string">'\n'</span>)</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    outfile.close()</span><br><span class="line">    Evaluate(TList,PList)</span><br><span class="line">    <span class="keyword">for</span> classid <span class="keyword">in</span> ClassProb.keys():</span><br><span class="line">        pre,rec = CalPreRec(TList, PList,classid)</span><br><span class="line">        print(<span class="string">"Precision and recall for Class"</span>,classid,<span class="string">":"</span>,pre,rec)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"Usage incorrect!"</span>)</span><br></pre></td></tr></table></figure>
<hr>
<p>欢迎关注公众号：「努力给自己看」</p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g8zwbmurouj305k05kmxb.jpg" alt="公众号200x200"></p>
<p>​    </p>
<p>​    </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="default">
    <link itemprop="mainEntityOfPage" href="https://caixiaobai.github.io/2019/01/08/推荐系统-Item-Based-CF实例/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KeepUp">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KeepUp's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/01/08/推荐系统-Item-Based-CF实例/" class="post-title-link" itemprop="url">推荐系统-Item Based CF实例</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-01-08 21:10:51" itemprop="dateCreated datePublished" datetime="2019-01-08T21:10:51+08:00">2019-01-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-11-16 15:09:36" itemprop="dateModified" datetime="2019-11-16T15:09:36+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index"><span itemprop="name">大数据</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>前边我们已经简单介绍了基于内容的推荐系统CB和基于协同过滤的推荐系统CF，今天我们就来看一个基于协同过滤中的基于物品的 Item Based CF 的一个实际实例来帮助大家更好的来了解和掌握以前的知识。</p>
<p>下面我们来看看我们的元数据，数据很简单，每一行由userId（用户ID）、itemId（物品ID）、score（用户打分）组成，之间用”，“分隔。</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNc79ly1fyzjsurmagj30ia0e4jtt.jpg" alt="image-20190108223153096"></p>
<p>我们计算的时候用下边这个相似度计算公式，这个公式其实本质上和cos相似度计算公式一样。</p>
<script type="math/tex; mode=display">
W_{i,j}=\frac {(\sum_{u\in U(i,j)}r_{ui}*r_{uj})*(|U(i,j)|-1)}{\sqrt[]{\sum_{u\in U(i,j)}r_{ui}^2*\sum_{u\in U(i,j)}r_{uj}^2}*(|U(i,j)|-1+\lambda)}</script><p>其中：</p>
<p>​    $W_{i,j}$ 表示标号为i和j的两个item的相似度</p>
<p>​    $U(i,j)$ 表示同时对i和j两个有评分的用户的集合</p>
<p>​    $r_{ui}$ 表示用户u对item i的评分</p>
<p>​    $\lambda$ 为平滑参数</p>
<p>实际上我们在用的时候可以把分子分母相乘的后半部分当做一个常数舍去，对结果没有没有影响。那我们在计算的时候就可以只看前半部分了，通过分析我们就会发现，对于每个用户来说分母都是相同的，是所有用户对i的打分的平方和然后乘以所有用户对j的打分的平方和，而分子就是自己对i和j的乘积，我们分别把分母拆开，就可以得出其实就是自己对i的打分除以所有用户对i的打分的平方和（相当于归一化）然后乘以自己对i的打分除以所有用户对i的打分的平方和。由此我们代码实现的时候就很简单了。</p>
<p>我们举一个简单的例子来说明这个公式怎么应用</p>
<div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th>item1</th>
<th>item2</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>2</td>
<td>5</td>
</tr>
<tr>
<td>B</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>C</td>
<td>4</td>
<td>2</td>
</tr>
</tbody>
</table>
</div>
<p>我们要计算item1和item2的相似度，现在我们已经知道了所有同时对两个物品打分的用户A、B、C那么两个物品的相似度计算过程，首先把打分进行归一化，先求得所有用户对item1的打分的平方和 $2^2+1^2+4^2=20$ 然后求得所有用户对item2的打分的平方和$5^2+3^2+2^2=38$ 然后对所有打分进行归一化后再分别相乘求和，最后的相似度为</p>
<script type="math/tex; mode=display">
相似度=\frac{2}{20}*\frac{5}{38}+\frac{1}{20}*\frac{3}{38}+\frac{4}{20}*\frac{2}{38}</script><p>那么我们现在就有了一个思路，首先把所有打分进行归一化计算，然后找出所有对i和j打分的集合，然后计算出i和j的相似度。</p>
<p>下面就是按照这个思路的代码实现，代码为python写的MapReduce任务。</p>
<ul>
<li><p>归一化并两两取对过程 </p>
<p>map1.py</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python </span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">item_score_dic = &#123;&#125;</span><br><span class="line">user_item_score_list = []</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</span><br><span class="line">    ss = line.strip().split(<span class="string">','</span>)</span><br><span class="line">    <span class="keyword">if</span> len(ss) != <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    user = ss[<span class="number">0</span>].strip()</span><br><span class="line">    item = ss[<span class="number">1</span>].strip()</span><br><span class="line">    score = float(ss[<span class="number">2</span>].strip())</span><br><span class="line">    user_item_score_list.append((user,item,score))</span><br><span class="line">    score = pow(score,<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">if</span> item_score_dic.has_key(item):</span><br><span class="line">        item_score_dic[item] += score</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        item_score_dic[item] = score</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> uis <span class="keyword">in</span> user_item_score_list:</span><br><span class="line">    user, item, score = uis</span><br><span class="line">    <span class="keyword">if</span> item_score_dic.has_key(item):</span><br><span class="line">        score_sqr = math.sqrt(item_score_dic[item])</span><br><span class="line">        <span class="keyword">print</span> (<span class="string">'\t'</span>.join([user,item,score/score_sqr]))</span><br></pre></td></tr></table></figure>
<p>​    reduce1.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">current_user = <span class="keyword">None</span></span><br><span class="line">item_score_list = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</span><br><span class="line">    ss = line.strip().split(<span class="string">'\t'</span>)</span><br><span class="line">    <span class="keyword">if</span> len(ss) != <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    user = ss[<span class="number">0</span>].strip()</span><br><span class="line">    item = ss[<span class="number">1</span>].strip()</span><br><span class="line">    score = float(ss[<span class="number">2</span>].strip())</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> current_user:</span><br><span class="line">        current_user = user</span><br><span class="line">    <span class="keyword">if</span> current_user != user:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(item_score_list) - <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(i+<span class="number">1</span>, len(item_score_list)):</span><br><span class="line">                item_a, score_a = item_score_list[i]</span><br><span class="line">                item_b, score_b = item_score_list[j]</span><br><span class="line">                print(<span class="string">'\t'</span>.join([item_a, item_b, score_a * score_b]))</span><br><span class="line">                print(<span class="string">'\t'</span>.join([item_b, item_a, score_a * score_b]))</span><br><span class="line">        item_score_list = []</span><br><span class="line">        current_user = user</span><br><span class="line"></span><br><span class="line">    item_score_list.append((item, score))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(item_score_list) - <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(i + <span class="number">1</span>, len(item_score_list)):</span><br><span class="line">        item_a, score_a = item_score_list[i]</span><br><span class="line">        item_b, score_b = item_score_list[j]</span><br><span class="line">        print(<span class="string">'\t'</span>.join([item_a, item_b, score_a * score_b]))</span><br><span class="line">        print(<span class="string">'\t'</span>.join([item_b, item_a, score_a * score_b]))</span><br></pre></td></tr></table></figure>
<ul>
<li><p>item1和item2相似对求和阶段</p>
<p>map2.py</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</span><br><span class="line">    ss = line.strip().split(<span class="string">'\t'</span>)</span><br><span class="line">    <span class="keyword">if</span> len(ss) != <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    item_a = ss[<span class="number">0</span>].strip()</span><br><span class="line">    item_b = ss[<span class="number">1</span>].strip()</span><br><span class="line">    score = ss[<span class="number">2</span>].strip()</span><br><span class="line">    print(<span class="string">'%s#%s\t%s'</span> % item_a, item_b, score)</span><br></pre></td></tr></table></figure>
<p>​    reduce2.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">current_items = <span class="keyword">None</span></span><br><span class="line">sum = <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</span><br><span class="line">    ss = line.strip().split(<span class="string">'\t'</span>)</span><br><span class="line">    <span class="keyword">if</span> len(ss) != <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    item_item = ss[<span class="number">0</span>].strip()</span><br><span class="line">    score = float(ss[<span class="number">1</span>].strip())</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> current_items:</span><br><span class="line">        current_items = item_item</span><br><span class="line">    <span class="keyword">if</span> current_items != item_item:</span><br><span class="line">        item_a, item_b = current_items.split(<span class="string">'#'</span>)</span><br><span class="line">        print(<span class="string">'\t'</span>.join(item_a, item_b, sum))</span><br><span class="line">        sum = <span class="number">0.0</span></span><br><span class="line">        current_items = item_item</span><br><span class="line">        </span><br><span class="line">    sum += score</span><br><span class="line"></span><br><span class="line">item_a, item_b = current_items.split(<span class="string">'#'</span>)</span><br><span class="line">print(<span class="string">'\t'</span>.join(item_a, item_b, sum))</span><br></pre></td></tr></table></figure>
<p>以上就是算法的代码实现过程，这个算法有一个缺点就是，当数据量非常大的时候，物品两两取对的数量会非常大，很容易内存不够，所以在实际的应用中我们应该随机取一定量的数据进行计算，而不是把所有的数据都加到计算里边来。</p>
<hr>
<p>欢迎关注公众号：「努力给自己看」</p>
<p><img src="https://ws1.sinaimg.cn/large/006tNbRwly1fxrdvrckwcj308c08b3zp.jpg" alt="公众号200x200"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="default">
    <link itemprop="mainEntityOfPage" href="https://caixiaobai.github.io/2019/01/06/摆脱你的拖延症/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KeepUp">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KeepUp's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/01/06/摆脱你的拖延症/" class="post-title-link" itemprop="url">摆脱你的拖延症</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-01-06 20:23:06" itemprop="dateCreated datePublished" datetime="2019-01-06T20:23:06+08:00">2019-01-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-11-16 15:09:55" itemprop="dateModified" datetime="2019-11-16T15:09:55+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/个人随笔/" itemprop="url" rel="index"><span itemprop="name">个人随笔</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>曾经在一本书里看到，说有拖延症的人占所有人的70%到80%左右，我并不同意这个说法，我认为100%的人都有拖延症，你想想，你是不是有买了一本书，却一直放书架上吃灰，从来没有打开过或者只是打开了几页，是不是一直想开始自己的减肥计划，然后却各种借口一直没有开始，是不是工作中有某一项或者某几项工作早就分配给你了，然后你一直拖着不愿意去做，等到deadline拖无可拖的才不得已去做。所以我认为所有人都有拖延症，只是有些人找到了适合自己的方法，有效的克服了这一现象，表现的不太明显而已，另一些人则被拖延症深深的困扰着。</p>
<p>拖延症是什么？就是你自己明明知道某一件事是对自己有意义的，但是就是拖着不去做这件事，拖着不干的同时心里还有强烈的焦虑感和负罪感。拖延症不是懒，如果是单纯的懒得话，就不会觉得焦虑和有负罪感了，懒是我根本懒得去做这件事。好多人在开始某些工作的时候，总是给自己找各种拖延的理由，今天身体有些不舒服，还是明天再开始把；今天工作或者生活遇到了什么不顺心的事情，心情不好，明天在开始吧；今天又加班了，很累，给自己放一天假吧，明天再继续。</p>
<p>拖延症为什么很难去克服和战胜，因为那些有意义的事情往往属于“慢效应”，带来的反馈和收获是缓慢增长的，而且是需要长期坚持下来才能看到效果的。比如我们减肥，阅读，写作等等，而我们对那些“快效应”的事情是不存在拖延症的，比如打游戏、刷微博、刷头条、追剧等等，因为这些事情的反馈是及时的，马上就能带来心理和精神上的满足。但是这些满足来的快，去的也快，只要一结束一停下来，立马又觉得的空虚了，然后为了获得满足就会再次进去，形成了一个恶性循环。时间一长我们习惯了这种“快效应”的东西，就会没有耐心去做那些”慢效应“的事情，然后往往是这些”慢效应“的事情带给我们的收获和满足是持续并长久的。</p>
<p>我自己也有拖延症，我也很明确的知道这一点。我也有很多书从买回来翻过几页之后就一直放着吃灰再也没打开过，我的跑步计划也已经夭折了好几次，我也有很多工作一直拖到deadline的时候没办法拖了才会开始去做。所以我一直在找适合我自己的克服拖延症的办法。我试过番茄工作法，试过把大任务分解成小任务等好多办法，但是试过之后觉得对我来说并没有多大的作用。当然我也找到了几个适合自己的方法，下边就把适合我自己的方法分享给你，当然这些方法并不一定适合你，所以你也要自己去发现适合自己的方法。</p>
<p>1、逼着自己去迈出第一步。只要你迈出了第一步，只要你开始做了，就会发现原来并没有我们原本想象的那么困难，并且有时候这个想象和现实的”落差“，会让我们有一种意外的惊喜。慢慢做着做着不知不觉就把这件事完成了。</p>
<p>2、如果实在是没办法逼着自己去迈出那第一步，那么也要去浏览一下这项工作的大致内容，然后你在做别的事情或者休息的时候，看似做着和那项工作无关的事情，然而我们的大脑其实一直在为那件事准备着，构思着，梳理着，等你真正开始的时候，你发现自己已经有了大致的思路和框架，可以用很快的时间很高的效率来完成这件事。</p>
<p>3、找多个人来监督自己，可以把自己的想法或者计划发到微博或者朋友圈，让自己的亲朋好友看到，话都说出去了，被这么多人看到，如果你不去做的话，面子上也过不去啊，这样我们的虚荣心反而会推动着我们去克服自己的拖延症。</p>
<p>4、给自己定一个很激励自己的目标，并写在你每天可以看到的地方，时刻提醒自己。比如自己的男神或者女神喜欢健身，并且身材很好，那么好，为了接近甚至追上自己的男神女神，给自己定一个健身的目标，每天提醒自己，不久的将来我就可以自信的站到男神女神的面前了，甚至有可能会梦想成真呢，想想是不是都动力十足呢。</p>
<p>5、选择性拖延，把自己不愿意开始一直拖着的工作都列出来，然后从里边选一个相对比较喜欢的开始做起。这样虽然也有些事情会拖延，但是起码我们没有浪费时间，做的事情都是从对自己有意义的事情里边选的，总比所有事情都拖着而去玩游戏，刷微博头条来得好。</p>
<p>以上就是我找到的适合自己的几个方法，如果也对你有效果的话，我也很高兴能帮到你，如果对你效果不大，那么或许还是需要你自己去寻找适合你自己的方法。当然，其实有一种理想情况下可以彻底摆脱我们的拖延症，那就是人人都做着自己喜欢的工作，这样就不会有拖延症的出现了，因为喜欢啊。会不会真的有这么一天呢？将来的事谁又说得准呢。</p>
<hr>
<p>欢迎关注公众号：「努力给自己看」</p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g8zw9d0hq4j305k05kmxb.jpg" alt="公众号200x200"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="default">
    <link itemprop="mainEntityOfPage" href="https://caixiaobai.github.io/2019/01/06/写给年轻人的一封信/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KeepUp">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KeepUp's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/01/06/写给年轻人的一封信/" class="post-title-link" itemprop="url">写给年轻人的一封信</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-01-06 20:20:14 / Modified: 20:22:32" itemprop="dateCreated datePublished" datetime="2019-01-06T20:20:14+08:00">2019-01-06</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/个人随笔/" itemprop="url" rel="index"><span itemprop="name">个人随笔</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>我这里写的年轻人是正在上大学或者刚刚毕业步入社会的这一撮人。虽然我是90年的，但是感觉自己已经老了。。。所以我觉得在上大学或者刚刚毕业的才是年轻人。也不知道当年我的父母是怎么想的，给我上户口的时候还把我写大了一岁， 写成了89 年(猜测是想让我早点成家立业，事实证明我也没有辜负两位老人的期望)，小时候还觉得大一岁也没什么，但是随着年龄一年一年的增加越来越后悔当时父母怎么没把我写的晚出生一年呢。毕竟谁不想年轻一点呢。</p>
<p>言归正传，今天写这封信，是想以过来人的身份告诉现在的年轻人，应该怎么度过这几年宝贵的“年轻”时光，也并不是说我自己当时做的如何的好，相反，我是这这段时光的虚度者、失败者，现在还在经常的后悔，自己浪费了一生中最为宝贵的那段时光，可是时间永远也不可能让你重新来过。所以我想分享自己的经验教训给你，把我这个反面的例子展示给你看，让你引以为戒，不要重蹈覆辙。</p>
<p>我在小学的时候其实成绩很好，经常在放学的路上还在思考当天课程中的问题或者老师留的课后作业，许多的问题和难题都是在这种情况下思考出来的，这或许是因为当时我是真的发自内心的喜欢学习，对学习有很高的兴趣。然而这种情况在初中慢慢发生了改变，初中我被送去了寄宿学校，是当时市里最严格的学校。每天课业繁重，从早上六点一直到晚上九点，我们的时间被排的慢慢的，根本没有课余玩耍休息的时间，甚至一个月才有一天假期回家一天。我对学习的兴趣和激情慢慢被这繁重的课程和沉重的压力磨灭殆尽，虽然成绩还在中上游，但是再也没有了以前的主动思考和学习的激情。到了高中这种情况变得更为严重，学校、老师、家长和学生都在为了那个能决定命运的高考努力着。在失去了最初的兴趣和激情之后，我也只是考上了一个普通的二本学校。</p>
<p>或许是因为初中、高中的高强的压力和管束，导致了我到了大学之后，突然到了一个自己相对自由，没有那么多管束和压力的环境中，过度的放纵自己，觉得我终于自由了，终于不用天天被人逼着去上课，去学习了。我可以做自己想做的事，我甚至可以逃课去打球，去网吧，去逛街。四年的大学时光基本上是在打游戏，打篮球，逃课，谈恋爱。。中度过的。甚至中间还有过一次挂科，然而我还用“没有挂科的大学是不完整的”来自我安慰。</p>
<p>有时候我就在想，是不是因为初高中的高强压力，才有了我自己大学时候的强烈反弹。如果初中高中的环境不是那个样子，我的大学会不会是另外一幅场景。是不是国内这种为了中考、高考为目标的高强压力下，催生了无数我这种大学里强烈反弹，厌学的大学生。当然，有人可能会说为什么在同样的环境下，还是会有很多一直坚持在努力学习的学生。你这么说只是在为自己找借口。我承认这也和个人的性格、自制力、毅力等因素有很大的关系。</p>
<p>如果你现在还是一名大学生，那么你起码为了最终能顺利毕业拿到证书而去认真学习每一科的课程，这些知识也是你将来工作中最基础的东西。不管你喜不喜欢你现在的专业，你都应该熟练的掌握这些知识。不要等到真正工作后用到了再回过头来学习，因为工作后你再也没有像在学校那样，有大把的时间可以学习。你应该提前浏览一下自己专业的招聘网站，看看你目标岗位的专业要求，这样你可以有个方向有目标的去学习和准备相关的知识和技能。将来找工作的时候就比别人更有优势。</p>
<p>你应该坚持锻炼身体，不管是跑步，打篮球，踢足球，你应该有一项喜欢的体育运动。身体是革命的本钱，拥有一个健康的身体是所有一切的前提，这样你才能去面对将来工作和生活的压力。才不会被轻易的被击倒。也是对自己，对我们爱的和爱我们的人负责。</p>
<p>你应该培养一个自己的兴趣爱好当做你的第二技能，可能你并不是很喜欢自己的专业，那就更需要拥有一个自己喜欢的爱好。这样我们在将来工作烦闷的时候有另外的一件事情可以让我们放松和调节我们的心情和心态。你的兴趣爱好可以是唱歌，可以是乐器，可以是写作，可以是健身等，只有是你自己喜欢的都可以。将来你还可以用自己的第二技能去赚钱，甚至可能会超过你的工作收入。如果你喜欢健身，你可以做兼职的教练，教别人怎么健身；你喜欢写作，你可以写文章或者自己出书来获取稿费。所以你应该培养自己的第二技能。</p>
<p>你应该坚持学习，并不是只有在学生时代才需要学习。人的一生都应该坚持学习，你可以学习自己工作专业相关的知识，来让自己更为精通和专业，从而实现升职加薪。 你也可以学习专业之外的知识，来开阔自己的视野，提高自己的认知水平。社会在快速发展着，新的知识和技术在飞速的迭代着，为了能跟上时代的步伐，不被时代所抛弃，我们也应该坚持学习。</p>
<p>你应该跳出自己的舒适区，去挑战新的东西。每个人总有自己习惯待的位置、习惯扮演的角色、习惯做的事，也就是我们的舒适区。如果一个人长时间呆在自己的舒适区，带来的就是思想上的懒惰，行动上的停滞。舒适区可能会暂时缓解我们的焦虑和恐惧，但是却会让我们失去真正的机遇和成长。我们应该勇敢的跳出自己的舒适区，去面对自己害怕的事情，只要你迈出关键性的一步，你会发现并没有什么可怕的，你总能战胜它，这将带来你无法想象的好处。你不逼自己一把，永远不知道自己有多大的潜力。</p>
<p>你应该努力。很多人觉得我不需要成为多么成功有多大成就的人，我只想享受岁月静好。我想也许是你还没有感受到生活给你的压力，一定是有人在帮你顶着生活的压力在艰难前行，那一定是爱你的人。我们不可能一直生活在别人的呵护之下，总有一天需要我们自己去扛起这些沉甸甸的东西，只是早晚而已。职场中有这么一句笑话“年轻人是不能批评的，说几句就会离职，中年人随便骂，上有老下有小职场没有竞争力，怎么骂都会忍者干下去”，可是这是许多人的真实写照，如果你看到觉得好笑，那是你还没到中年。所以你应该努力，努力让爱我们和我们爱的人幸福。这是我们的责任和担当。</p>
<hr>
<p>欢迎关注公众号：「努力给自己看」</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79ly1fyvim1mppnj305k05k0t2.jpg" alt="公众号200x200"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="default">
    <link itemprop="mainEntityOfPage" href="https://caixiaobai.github.io/2019/01/04/推荐算法——CF/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KeepUp">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KeepUp's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/01/04/推荐算法——CF/" class="post-title-link" itemprop="url">推荐算法——CF</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-01-04 21:56:30" itemprop="dateCreated datePublished" datetime="2019-01-04T21:56:30+08:00">2019-01-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-11-16 15:09:42" itemprop="dateModified" datetime="2019-11-16T15:09:42+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index"><span itemprop="name">大数据</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>前边我们已经介绍了推荐算法里的基于内容的推荐算法CB，今天我们来介绍一下基于协同的推荐算法Collaboration Filtering（CF）。协同过滤是一个利用群体智慧的一个算法，举一个简单的例子，如果放假了你想去北京玩几天，但是不知道北京都有哪些好玩的，你会怎么做？你可能会上网查一下网友的推荐，也可能会咨询一下曾经去过北京的亲朋好友，最后你很可能会采纳你好朋友的推荐。因为你的好朋友和你相似的爱好和品味。</p>
<p>基于协同的推荐算法又分为两种</p>
<ul>
<li>User Based CF</li>
</ul>
<p>基于当前用户对物品的偏好找到相似偏好的用户，然后把相似偏好用户喜欢的物品推荐给当前用户。例如下图，对于 user1，我们找到了和他有相似偏好的 user3，他们都同时喜欢 Item1 和Item3 ，并且 user3 还喜欢 Item4，我们就可以把 Item4 推荐给 user1。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">user/item</th>
<th style="text-align:center">Item1</th>
<th style="text-align:center">Item2</th>
<th style="text-align:center">Item3</th>
<th style="text-align:center">Item4</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">User1</td>
<td style="text-align:center">✔️</td>
<td style="text-align:center"></td>
<td style="text-align:center">✔️</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">User2</td>
<td style="text-align:center"></td>
<td style="text-align:center">✔️</td>
<td style="text-align:center"></td>
<td style="text-align:center">✔️</td>
</tr>
<tr>
<td style="text-align:center">User3</td>
<td style="text-align:center">✔️</td>
<td style="text-align:center"></td>
<td style="text-align:center">✔️</td>
<td style="text-align:center">✔️</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>Item Based CF</li>
</ul>
<p>原理和基于用户的类似，只是在计算时基于物品而不是用户，找到和当前用户喜欢的物品相似的物品，然后推荐给当前用户。例如下图，我们发现喜欢 Item1 的用户都喜欢 Item3，并且还有很多也喜欢 Item4，我们就认为 Item1、Item2 和 Item4 比较相似，所以我们就可以把 Item4推荐给 user1。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>user/item</th>
<th>Item1</th>
<th>Item2</th>
<th>Item3</th>
<th>Item4</th>
</tr>
</thead>
<tbody>
<tr>
<td>User1</td>
<td>✔️</td>
<td></td>
<td>✔️</td>
<td></td>
</tr>
<tr>
<td>User2</td>
<td>✔️</td>
<td>✔️</td>
<td>✔️</td>
<td>✔️</td>
</tr>
<tr>
<td>User3</td>
<td>✔️</td>
<td></td>
<td>✔️</td>
<td>✔️</td>
</tr>
</tbody>
</table>
</div>
<p>协同过滤的实现，一般通过以下几个步骤</p>
<ul>
<li>收集用户对物品的偏好数据</li>
</ul>
<p>通常把用户对物品的行为数据收集起来，然后根据不同的行为数据来标志用户对该物品的喜欢程度，然后根据喜欢程度给物品一个打分。比如说一个电商网站，根据用户的浏览，收藏，加购物车，购买，评论等行为数据来进行打分，标志用户对这个物品的喜爱程度。</p>
<ul>
<li>通过计算找到相似的用户或物品</li>
</ul>
<p>然后像上边举得两个例子那样，通过一些算法，来找到和该用户有相似偏好的用户，或者找到和该用户喜欢的物品相似的物品。</p>
<ul>
<li>然后把相似度较高的n个结果推荐给用户</li>
</ul>
<p>最后从得到的推荐列表里挑选分数较高的n个结果推荐给用户</p>
<p>基于用户和基于物品的协同过滤有各自的优点和不足，我们使用的时候要根据具体的场景和情况来选择合适的来使用。最后来比较一下两者的不同。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">user based</th>
<th style="text-align:center">item based</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">性能</td>
<td style="text-align:center">适用用户较少的场合，如果用户数量较多，计算用户相似矩阵代价太大</td>
<td style="text-align:center">适用于物品数量明显小于用户数量的场合，如果物品很多，计算物品的相似矩阵代价太大</td>
</tr>
<tr>
<td style="text-align:center">领域</td>
<td style="text-align:center">时效性强，用户个性化兴趣不太明显的领域</td>
<td style="text-align:center">长尾物品丰富，用户个性化需求较强的领域</td>
</tr>
<tr>
<td style="text-align:center">实时性</td>
<td style="text-align:center">用户有新行为，不一定造成推荐结果立即变化</td>
<td style="text-align:center">用户有新行为，一定会导致推荐结果的变化</td>
</tr>
<tr>
<td style="text-align:center">冷启动</td>
<td style="text-align:center">在新用户对很少的物品产生行为后，不能马上对他进行个性化推荐，因为用户相似度表是每隔一段时间离线计算的。新物品上线后，一旦有用户对它产生行为，就可以把该物品推荐给和该用户有相似偏好的其他用户</td>
<td style="text-align:center">新用户只要对一个物品产生行为，就可以给他推荐和该物品相似的其他物品，但是没办法在不离线更新新物品相似度表的情况下把新物品推荐给用户</td>
</tr>
<tr>
<td style="text-align:center">推荐理由</td>
<td style="text-align:center">很难提供令用户信服的推荐解释</td>
<td style="text-align:center">利用用户的历史行为给用户做推荐解释，可以令用户比较信服</td>
</tr>
</tbody>
</table>
</div>
<p>基于协同的推荐算法也有自己的优缺点</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>优点</th>
<th>缺点</th>
</tr>
</thead>
<tbody>
<tr>
<td>用户模型刻画用户兴趣需求</td>
<td>推荐精度低（仅仅依赖于物品分析，没有其他分析数据）</td>
</tr>
<tr>
<td>推荐形式多样性，具有个性化</td>
<td>马太效应（可能连环看一类的，只能推一类视频）</td>
</tr>
<tr>
<td>结果可解释</td>
<td>用户行为稀疏导致覆盖率低</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>欢迎关注公众号：「努力给自己看」</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79ly1fyvim1mppnj305k05k0t2.jpg" alt="公众号200x200"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="default">
    <link itemprop="mainEntityOfPage" href="https://caixiaobai.github.io/2019/01/04/推荐算法——基于内容的推荐CB/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KeepUp">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KeepUp's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/01/04/推荐算法——基于内容的推荐CB/" class="post-title-link" itemprop="url">推荐算法——基于内容的推荐CB</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-01-04 20:59:58" itemprop="dateCreated datePublished" datetime="2019-01-04T20:59:58+08:00">2019-01-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-11-16 15:09:45" itemprop="dateModified" datetime="2019-11-16T15:09:45+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index"><span itemprop="name">大数据</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>推荐系统不仅可以有效地帮助用户发现高质量的适合自己的信息，另一方面也帮助应用和商家增加用户的使用时长，更好的留住用户。推荐系统越精准，用户的体验更好，商家获得的回报越大。所以这也是推荐系统应用越来越广泛的主要原因。 </p>
</blockquote>
<p>现在我们的生活和学习中处处都可以看到推荐系统的应用，比如我们打开百度首页，就可以看到给我们推荐的新闻热点。 </p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g8zwbzl7y1j31470u0ag8.jpg" alt="image-20190104210547958"></p>
<p>比如我们打开优酷看视频的时候 </p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g8zwbxt185j31hf0u0qhb.jpg" alt="image-20190104210740481"></p>
<p>还有微博，今日头条，抖音，京东，淘宝等等越来越多的地方会看到推荐系统的应用。 </p>
<h4 id="什么是CB推荐算法"><a href="#什么是CB推荐算法" class="headerlink" title="什么是CB推荐算法"></a>什么是CB推荐算法</h4><p>基于内容的推荐算法是众多算法中最基本的一种，就是根据用户过去喜欢的内容或者物品，通过复杂的数学计算找出与这些内容和物品相似的，然后推荐给用户。算法的核心就是内容的相似度。 </p>
<p>CB推荐算法主要有以下几个过程 </p>
<ol>
<li><p>提取内容或者物品（我们以后统称为Item）的特征 </p>
</li>
<li><p>根据用户以前的喜欢的和不喜欢的Item的特征进行计算，得出用户喜欢的特征 </p>
</li>
<li><p>根据用户喜欢的特征，去Item候选中，找出相关性最大的n个Item，然后推荐给用户 </p>
</li>
</ol>
<p>举个简单的例子： </p>
<p>一个用户在优酷看了一个成龙的一个动作喜剧电影。然后就根据这个电影提取出他的几个特征，”成龙“ ”动作“ ”喜剧“ 然后推断出这个用户可能喜欢的电影就是具有这几个特征的电影，然后就可以推荐一写其他的成龙的电影，其他的动作片，其他的喜剧片给这个用户。 </p>
<p>CB算法的优点： </p>
<ul>
<li><p>提升推荐结果的相关性 </p>
</li>
<li><p>结果可解释 </p>
</li>
<li><p>推荐结果容易被用户感知 </p>
</li>
<li><p>新的Item也可以马上被推荐 </p>
</li>
</ul>
<p>CB算法的缺点： </p>
<ul>
<li><p>无个性化 </p>
</li>
<li><p>依赖于对Item的深度分析，Item特征抽取有时候比较困难 </p>
</li>
<li><p>无法挖掘用户的潜在兴趣 </p>
</li>
<li><p>无法为新用户产生推荐 </p>
</li>
</ul>
<hr>
<p>欢迎关注公众号：「努力给自己看」</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79ly1fyvim1mppnj305k05k0t2.jpg" alt="公众号200x200"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="default">
    <link itemprop="mainEntityOfPage" href="https://caixiaobai.github.io/2018/12/10/告诉你什么是LCS/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KeepUp">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KeepUp's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/10/告诉你什么是LCS/" class="post-title-link" itemprop="url">告诉你什么是LCS</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-12-10 22:01:19" itemprop="dateCreated datePublished" datetime="2018-12-10T22:01:19+08:00">2018-12-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-11-16 15:09:52" itemprop="dateModified" datetime="2019-11-16T15:09:52+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据学习/" itemprop="url" rel="index"><span itemprop="name">大数据学习</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="LCS是什么"><a href="#LCS是什么" class="headerlink" title="LCS是什么"></a>LCS是什么</h4><p>LCS是Longest Common Subsequence的缩写，即最长公共子序列。一个序列，如果是两个或者多个序列的子序列，并且是所有子序列中最长的，则为最长公共子序列。（有序但不连续也为子序列）</p>
<ul>
<li>序列 13456 和 345674 的最长公共子序列为 3456</li>
<li>序列 ABDBC 和 BCDBA 的最长公共子序列为 BDB</li>
</ul>
<h4 id="LCS可以用来做什么"><a href="#LCS可以用来做什么" class="headerlink" title="LCS可以用来做什么"></a>LCS可以用来做什么</h4><ul>
<li>生物学上用来进行基因序列比对，以推测序列的结构、功能和演化过程</li>
<li>用来描述两段文字的”相似性“，可以用来辨别是不是抄袭</li>
</ul>
<h4 id="怎么计算LCS"><a href="#怎么计算LCS" class="headerlink" title="怎么计算LCS"></a>怎么计算LCS</h4><ul>
<li><p>暴力穷举法</p>
<p>就是把两个序列所有的子序列都列出来，然后一一进行比较。</p>
<p>假定字符串 A 和 B 的长度分别为 n 和 m，那么 A 共有 $2^n-1$ 个子序列，B 共有 $2^m-1$ 个子序列，然后将任意两个进行一一比较，最后得出 A 和 B 的最长公共子序列。这种算法的时间复杂度是 $O(2^{n+m})$ ，复杂度太高，当然不推荐使用。</p>
</li>
<li><p>动态规划法</p>
<p>记：</p>
<p>字符串 A ，长度为 n ，从 1 开始；字符串 A ，长度为 n ，从 1 开始。</p>
<p>$A_i=<a_1,a_2,...ai>$ 即 A 序列的前 i 个字符 $(1\leq i \leq n)$ ($A_i$ 计做”字符串 A 的 i 前缀)</a_1,a_2,...ai></p>
<p>$B_j=<b_1,b_2,...bj>$ 即 B 序列的前 j 个字符 $(1\leq j \leq m)$ ($B_j$ 计做”字符串 B 的 j 前缀)</b_1,b_2,...bj></p>
<p>如果 $A_n=B_m$ (最后一个字符相同)，那么 A 和 B 的最长公共子序列 C 的最后一位 $C_k=A_n=B_m$ ，那么 $LCS(A,B)=LCS(A_n-1,B_m-1)+A_n$ </p>
<p>如果 $A_n\not=B_m$ ，那么他们的最长公共子序列 C 要么是 $LCS(A_{n-1},B_m)$ ，要么是 $LCS(A_n,B_{m-1})$ ，所以 $LCS(A,B)=max\{LCS(A_{n-1},B_m),LCS(A_n,B_{m-1})\}$</p>
<p>|      |  1   |  2   |  3   |  4   |  5   |  6   |  7   |<br>| :—: | :—: | :—: | :—: | :—: | :—: | :—: | :—: |<br>|  A   |  B   |  D   |  C   |  A   |  B   |  A   |      |<br>|  B   |  A   |  B   |  C   |  B   |  D   |  A   |  B   |</p>
<p>$A_3=B_3= ‘C’$  那么 $LCS(BDC,ABC)=LCS(BD,AB)+’C’$ </p>
<p>$A_5=B_4=’B’$  那么 $LCS(BDCAB,ABCB)=LCS(BDCA,ABC)+’B’$</p>
<p>$A_2\not=B_2$  那么 $LCS(BD,AB)=max\{LCS(B,AB),LCS(BD,A)\}$  </p>
<p>$A_4\not=B_5$  那么 $LCS(BDCA,ABCBD)=max\{LCS(BDC,ABCBD),LCS(BDCA,ABCB)\}$ </p>
<p>由以上可以得出</p>
</li>
</ul>
<script type="math/tex; mode=display">
LCS(A_n,B_m)=\begin{cases}LCS(A_{n-1},B_{m-1}+A_n) \quad \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \quad A_n=B_m\\ max\{LCS(A_{n-1},B_m),LCS(A_n,B_{m-1})\} \quad A_n\not=B_m\end{cases}</script><h4 id="使用动态规划法求解"><a href="#使用动态规划法求解" class="headerlink" title="使用动态规划法求解"></a>使用动态规划法求解</h4><p>首先上一幅图</p>
<p><img src="https://ws1.sinaimg.cn/large/006tNbRwly1fy37g4jwguj30ae0ao3z7.jpg" alt="0_1313577405FsRn.gif"></p>
<p>记一个二维数组 $c[m,n]$，$c[i,j]$ 的值为 $x_i$ 和 $y_j$ 的最长公共子序列的长度，然后不难得出当 $i=0$ 或 $j=0$ 的时候 $X_i$ 和 $Y_j$ 的最长公共子序列的长度。然后通过动态规划法的公式得出</p>
<script type="math/tex; mode=display">
c(i,j)=\begin{cases}0 \quad \quad \quad \quad i=0,j=0 \\ c(i-1,j-1) \quad \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \quad i>0,j>0,x_i=y_j\\ max\{c(i-1,j),c(i,j-1))\} \quad i>0,j>0,x_i\not=y_j\end{cases}</script><p>然后我们通过公式计算 $c(1,1)$ ，因为 $x_1$ 和 $y_1$ 不相等，得出 $c(1,1)=max \{ c(0,1),c(1,0) \}=0$ 。然后依次计算，就会得到图中的值，然后得出 $x$ 和 $y$ 的最长公共子序列的长度为4。我们在计算的时候会发现一个规律：当 $x_i=y_j$ 的时候 $c(i,j)$ 的值为左上角格子的数加1；当 $x_i\not=y_j$ 的时候 $c(i,j)$ 的值为左侧格子和上边格子中的较大的一个。</p>
<h4 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">str1 = sys.argv[<span class="number">1</span>]</span><br><span class="line">str2 = sys.argv[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">len1 = len(str1)</span><br><span class="line">len2 = len(str2)</span><br><span class="line"></span><br><span class="line">maxChildLen = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">lcs_ss = [[<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(len2 + <span class="number">1</span>)] <span class="keyword">for</span> j <span class="keyword">in</span> range(len1 + <span class="number">1</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len1 + <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, len2 + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> str1[i<span class="number">-1</span>] == str2[j<span class="number">-1</span>]:</span><br><span class="line">            lcs_ss[i][j] = lcs_ss[i<span class="number">-1</span>][j<span class="number">-1</span>] + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            lcs_ss[i][j] = max(lcs_ss[i<span class="number">-1</span>][j], lcs_ss[i][j<span class="number">-1</span>])</span><br><span class="line"></span><br><span class="line">maxChildLen = lcs_ss[len1][len2]</span><br><span class="line"></span><br><span class="line">print(<span class="string">"str1: %s"</span> % str1)</span><br><span class="line">print(<span class="string">"str2: %s"</span> % str2)</span><br><span class="line">print(<span class="string">"LCS: %s"</span> % maxChildLen)</span><br></pre></td></tr></table></figure>
<p>随便输入两个字符串，然后观察打印结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">str1: acedbae</span><br><span class="line">str2: becadeac</span><br><span class="line">LCS: <span class="number">3</span></span><br><span class="line"></span><br><span class="line">Process finished <span class="keyword">with</span> exit code <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>若有任何问题，恳请不吝指正。</p>
<hr>
<p>欢迎关注公众号：「努力给自己看」</p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g8zw9sw7ysj308c08bjru.jpg" alt="二维码"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="default">
    <link itemprop="mainEntityOfPage" href="https://caixiaobai.github.io/2018/12/09/TF-IDF介绍/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KeepUp">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KeepUp's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/09/TF-IDF介绍/" class="post-title-link" itemprop="url">TF-IDF介绍</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-12-09 10:50:19" itemprop="dateCreated datePublished" datetime="2018-12-09T10:50:19+08:00">2018-12-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-12-15 19:47:58" itemprop="dateModified" datetime="2018-12-15T19:47:58+08:00">2018-12-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据学习/" itemprop="url" rel="index"><span itemprop="name">大数据学习</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="TF-IDF是什么"><a href="#TF-IDF是什么" class="headerlink" title="TF-IDF是什么"></a>TF-IDF是什么</h4><p>TF-IDF是一种统计方法，用以评估一个词对于一篇文章或语料库中一篇文章的重要性。字词的重要性随着它在文件中出现的次数成正比增加，但同时会随着它在语料库中出现的频率成反比下降。</p>
<h4 id="TF-IDF的使用场景"><a href="#TF-IDF的使用场景" class="headerlink" title="TF-IDF的使用场景"></a>TF-IDF的使用场景</h4><p>TF-IDF加权的各种形式常被搜索引擎应用，作为文件与用户查询之间相关程度的度量或评级。除了TF-IDF以外，因特网上的搜索引擎还会使用基于链接分析的评级方法，以确定文件在搜寻结果中出现的顺序。</p>
<h4 id="TF-IDF原理"><a href="#TF-IDF原理" class="headerlink" title="TF-IDF原理"></a>TF-IDF原理</h4><ul>
<li><p>TF（Term Frequency) 表示词频，即一个词在在一篇文章中出现的次数，但在实际应用时会有一个漏洞，就是篇幅长的文章给定词出现的次数会更多一点。因此我们需要对次数进行归一化，通常用给定词的次数除以文章的总词数。        </p>
<script type="math/tex; mode=display">
TF_w = \frac{给定词w出现的次数}{文章的总次数}</script><p>​    </p>
<p>这其中还有一个漏洞，就是 ”的“  ”是“  ”啊“  等类似的词在文章中出现的此时是非常多的，但是这些大多都是没有意义词，对于判断文章的关键词几乎没有什么用处，我们称这些词为”停用词“，也就是说，在度量相关性的时候不应该考虑这些词的频率。</p>
</li>
<li><p>IDF（Inverse Document Frequency）逆文本频率指数，如果包含关键词w的文档越少，则说明关键词w具有很好的类别区分能力。某一关键词的IDF，可以用总的文章数量除以包含该关键词的文章的数量，然后对结果取对数得到</p>
<script type="math/tex; mode=display">
IDF_w = \log(\frac{语料库文章的总数}{包含关键词w的文章数量 + 1})</script><p>​        注：分母加1是为了避免没有包含关键词的文章时分母是0的情况</p>
</li>
</ul>
<p>一个词预测主题的能力越强，权重就越大，反之，权重越小，因此一个词的TF-IDF就是：</p>
<script type="math/tex; mode=display">
TF-IDF = TF*IDF</script><h4 id="实际应用"><a href="#实际应用" class="headerlink" title="实际应用"></a>实际应用</h4><p>通常在新闻的分类，或者说文章的分类的时候我们会用到ID-IDF。如果让编辑来对新闻或者文章分类，他一定要先读懂文章，然后找出主题，最后根据主题的不同对文章进行分类。而让电脑对文章进行分类，就要求我们先把文字的文章变成一组可以计算的数字，然后通过算法来算出文章的相似性。</p>
<p>首先我们先来看怎么用一组数字（或者说一个向量）来表示一篇文章。对于一篇文章的所有实词（除去无意义的停用词），计算出他们的TF-IDF值，把这些值按照对应的实词在词汇表的位置依次排列，就得到了一个向量。比如，词汇表中有64000个词，其编号和词：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">单词编号</th>
<th style="text-align:center">汉字词</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">阿</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">啊</td>
</tr>
<tr>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
</tr>
<tr>
<td style="text-align:center">789</td>
<td style="text-align:center">服装</td>
</tr>
<tr>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
</tr>
<tr>
<td style="text-align:center">64000</td>
<td style="text-align:center">做作</td>
</tr>
</tbody>
</table>
</div>
<p>在某一篇文章中，文章中的词的TF-IDF值对应为：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">单词编号</th>
<th style="text-align:center">TF-IDF</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">0.0034</td>
</tr>
<tr>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
</tr>
<tr>
<td style="text-align:center">789</td>
<td style="text-align:center">0.034</td>
</tr>
<tr>
<td style="text-align:center">…</td>
<td style="text-align:center">…</td>
</tr>
<tr>
<td style="text-align:center">64000</td>
<td style="text-align:center">0.075</td>
</tr>
</tbody>
</table>
</div>
<p>如果单词表的某个词在文章中没有出现，对应的值为零，这样我们就得到了一个64000维的向量，我们称为这篇文章的特征向量。然后每篇文章就可以用一个向量来表示，这样我们就可以计算文章之间的相似程度了。</p>
<p>向量的夹角是衡量两个向量相近程度的度量。因此，可以通过计算两篇文章的特征向量的夹角来判断两篇文章的主题的接近程度。那么我们就需要用余弦地理了。</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNbRwly1fy0embgpjfj30uw0f80tj.jpg" alt="屏幕快照 2018-12-09 下午12.57.16"></p>
<p>∠A的余弦值为：</p>
<script type="math/tex; mode=display">
cosA = \frac{b^2+c^2-a^2}{2bc}</script><p>如果将三角形的两边b和c看成是两个以A为起点的向量，那么上述公式等于：</p>
<script type="math/tex; mode=display">
cosA=\frac{<b,c>}{|b|·|c|}</script><p>其中，分母便是两个向量b和c的长度，分子表示两个向量的内积。假设文章X和文章Y对应的向量是 </p>
<script type="math/tex; mode=display">
X_1,X_2,...,X_{64000}和Y_1,Y_2,...,Y_{64000}</script><p>那么他们的夹角的余弦等于</p>
<script type="math/tex; mode=display">
cosθ=\frac{x_1y_1+x_2y_2+...+x_{64000}y_{64000}}{\sqrt{x_1^2+x_2^2+x_{64000}^2}\cdot\sqrt{y_1^2+y_2^2+y_{64000}^2}}</script><p>由于向量中的每一个变量都是正数，所以余弦的取值在0到1之间。当两篇文章向量的余弦等于1时，这两个向量夹角为零，两篇文章完全相同；当夹角的余弦接近于1时两篇文章越相似，从而可以归成一类；夹角的余弦越小，夹角越大，两篇文章越不相关。</p>
<p>现在假定我们已知一些文章的特征向量，那么对于任何一个要被分类的文章，就很容易计算出它和各类文章的余弦相似性，并将其归入它该去的那一类中。</p>
<p>如果事先没有已知的文章的特征向量呢，可以用自底向上不断合并的方法。</p>
<ol>
<li>计算所有文章之间凉凉的余弦相似性，把相似性大于一个阈值的合并成一小类</li>
<li>把每个小类中的所有文章作为一个整体，计算小类的特征向量，在计算小雷之间两两的余弦相似性，然后合并成一个大类</li>
</ol>
<p>这样不断做下去，类别越来越少，而每个类越来越大。当某一类太大时，这一类里的文章的相似性就很小了，这时就要停止迭代过程了，然后完成分类。</p>
<hr>
<p>欢迎关注公众号：「努力给自己看」</p>
<p><img src="https://ws1.sinaimg.cn/large/006tNbRwly1fxrdvrckwcj308c08b3zp.jpg" alt="二维码"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="default">
    <link itemprop="mainEntityOfPage" href="https://caixiaobai.github.io/2018/12/07/学习笔记—MapReduce/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KeepUp">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KeepUp's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/07/学习笔记—MapReduce/" class="post-title-link" itemprop="url">学习笔记—MapReduce</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2018-12-07 23:27:12 / Modified: 23:55:03" itemprop="dateCreated datePublished" datetime="2018-12-07T23:27:12+08:00">2018-12-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据学习/" itemprop="url" rel="index"><span itemprop="name">大数据学习</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="MapReduce是什么"><a href="#MapReduce是什么" class="headerlink" title="MapReduce是什么"></a>MapReduce是什么</h4><p>MapReduce是一种分布式计算编程框架，是Hadoop主要组成部分之一，可以让用户专注于编写核心逻辑代码，最后以高可靠、高容错的方式在大型集群上并行处理大量数据。</p>
<h4 id="MapReduce的存储"><a href="#MapReduce的存储" class="headerlink" title="MapReduce的存储"></a>MapReduce的存储</h4><p>MapReduce的数据是存储在HDFS上的，HDFS也是Hadoop的主要组成部分之一。下边是MapReduce在HDFS上的存储的图解</p>
<p><img src="http://hadoop.apache.org/docs/r3.1.1/hadoop-project-dist/hadoop-hdfs/images/hdfsarchitecture.png" alt="HDFS Architecture"></p>
<p>HDFS主要有Namenode和Datanode两部分组成，整个集群有一个Namenode和多个DataNode，通常每一个节点一个DataNode，Namenode的主要功能是用来管理客户端client对数据文件的操作请求和储存数据文件的地址。DataNode主要是用来储存和管理本节点的数据文件。节点内部数据文件被分为一个或多个block块（block默认大小原来是64MB，后来变为128MB），然后这些块储存在一组DataNode中。（这里不对HDFS做过多的介绍，后续会写一篇详细的HDFS笔记）</p>
<h4 id="MapReduce的运行流程"><a href="#MapReduce的运行流程" class="headerlink" title="MapReduce的运行流程"></a>MapReduce的运行流程</h4><p><img src="https://ws2.sinaimg.cn/large/006tNbRwly1fxw93ewkoej31720g4tfx.jpg" alt="屏幕快照 2018-12-05 下午10.43.38"></p>
<p><img src="https://ws1.sinaimg.cn/large/006tNbRwly1fxyltiwrcdj31gg0nw1kx.jpg" alt="屏幕快照 2018-12-05 下午10.56.38"></p>
<p>1、首先把需要处理的数据文件上传到HDFS上，然后这些数据会被分为好多个小的分片，然后每个分片对应一个map任务，推荐情况下分片的大小等于block块的大小。然后map的计算结果会暂存到一个内存缓冲区内，该缓冲区默认为100M，等缓存的数据达到一个阈值的时候，默认情况下是80%，然后会在磁盘创建一个文件，开始向文件里边写入数据。</p>
<p>2、map任务的输入数据的格式是<key,value>对的形式，我们也可以自定义自己的<key,value>类型。然后map在往内存缓冲区里写入数据的时候会根据key进行排序，同样溢写到磁盘的文件里的数据也是排好序的，最后map任务结束的时候可能会产生多个数据文件，然后把这些数据文件再根据归并排序合并成一个大的文件。</key,value></key,value></p>
<p>3、然后每个分片都会经过map任务后产生一个排好序的文件，同样文件的格式也是<key,value>对的形式，然后通过对key进行hash的方式把数据分配到不同的reduce里边去，这样对每个分片的数据进行hash，再把每个分片分配过来的数据进行合并，合并过程中也是不断进行排序的。最后数据经过reduce任务的处理就产生了最后的输出。</key,value></p>
<p>4、在我们开发中只需要对中间map和reduce的逻辑进行开发就可以了，中间分片，排序，合并，分配都有MapReduce框架帮我完成了。</p>
<h4 id="MapReduce的资源调度系统"><a href="#MapReduce的资源调度系统" class="headerlink" title="MapReduce的资源调度系统"></a>MapReduce的资源调度系统</h4><p>最后我们来看一下MapReduce的资源调度系统Yarn。</p>
<p><img src="http://hadoop.apache.org/docs/r3.1.1/hadoop-yarn/hadoop-yarn-site/yarn_architecture.gif" alt="MapReduce NextGenæ¶æ"></p>
<p>Yarn的基本思想是将资源管理和作业调度/监视的功能分解为单独的守护进程。全局唯一的ResourceManager是负责所有应用程序之间的资源的调度和分配，每个程序有一个ApplicationMaster，ApplicationMaster实际上是一个特定于框架的库，其任务是协调来自ResourceManager的资源，并与NodeManager一起执行和监视任务。NodeManager是每台机器框架代理，监视其资源使用情况（CPU，内存，磁盘，网络）并将其报告给ResourceManager。</p>
<h4 id="WordConut代码"><a href="#WordConut代码" class="headerlink" title="WordConut代码"></a>WordConut代码</h4><ul>
<li>python实现</li>
</ul>
<p>map.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</span><br><span class="line">    words = line.strip().split()</span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> words:</span><br><span class="line">        print(<span class="string">'%s\t%s'</span> % (word, <span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<p>reduce.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">current_word = <span class="keyword">None</span></span><br><span class="line">sum = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</span><br><span class="line">    word, count = line.strip().split(<span class="string">' '</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> current_word == <span class="keyword">None</span>:</span><br><span class="line">        current_word = word</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> word != current_word:</span><br><span class="line">        print(<span class="string">'%s\t%s'</span> % (current_word, sum))</span><br><span class="line">        current_word = word</span><br><span class="line">        sum = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    sum += int(count)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'%s\t%s'</span> % (current_word, sum))</span><br></pre></td></tr></table></figure>
<p>我们先把输入文件上传到HDFS上去</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -put /input.txt /</span><br></pre></td></tr></table></figure>
<p>​    然后在Linux下运行，为了方便我们把命令写成了shell文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">HADOOP_CMD="/usr/local/src/hadoop-2.6.1/bin/hadoop"</span><br><span class="line">STREAM_JAR_PATH="/usr/local/src/hadoop-2.6.1/share/hadoop/tools/lib/hadoop-streaming-2.6.1.jar"</span><br><span class="line"></span><br><span class="line">INPUT_FILE_PATH="/input.txt"</span><br><span class="line">OUTPUT_FILE_PATH="/output"</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span>HADOOP_CMD fs -rmr -skipTrush $OUTPUT_FILE_PATH</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span>HADOOP_CMD jar $STREAM_JAR_PATH \</span><br><span class="line">	-input $INPUT_FILE_PATH \</span><br><span class="line">	-output $OUTPUT_FILE_PATH \</span><br><span class="line">	-mapper "python map.py" \</span><br><span class="line">	-reducer "python reduce.py" \</span><br><span class="line">	-file "./map.py" \</span><br><span class="line">	-file "./reduce.py"</span><br></pre></td></tr></table></figure>
<ul>
<li>java实现</li>
</ul>
<p>MyMap.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.LongWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMap</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">LongWritable</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> IntWritable one = <span class="keyword">new</span> IntWritable(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">private</span> Text text = <span class="keyword">new</span> Text();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(LongWritable key, Text value, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">        String line = value.toString();</span><br><span class="line">        String[] words = line.split(<span class="string">" "</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (String word: words)&#123;</span><br><span class="line">            text.set(word);</span><br><span class="line">            context.write(text,one);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>MyReduce.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Reducer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyReduce</span> <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">IntWritable</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> IntWritable result = <span class="keyword">new</span> IntWritable();</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterable&lt;IntWritable&gt; values, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (IntWritable i:values)&#123;</span><br><span class="line">            sum+=i.get();</span><br><span class="line">        &#125;</span><br><span class="line">        result.set(sum);</span><br><span class="line">        context.write(key,result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>WordCount.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Job;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WordCount</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Configuration configuration = <span class="keyword">new</span> Configuration();</span><br><span class="line">        Job job = Job.getInstance(configuration, <span class="string">"WordCount"</span>);</span><br><span class="line">        job.setJarByClass(WordCount.class);</span><br><span class="line">        job.setMapperClass(MyMap.class);</span><br><span class="line">        job.setReducerClass(MyReduce.class);</span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputValueClass(IntWritable.class);</span><br><span class="line">        FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(args[<span class="number">0</span>]));</span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(args[<span class="number">1</span>]));</span><br><span class="line">        System.exit(job.waitForCompletion(<span class="keyword">true</span>) ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>把工程打成jar包，然后把jar包和输入文件上传到HDfs</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> hadoop fs -put /wordcount.jar /</span><br><span class="line"><span class="meta">$</span> hadoop fs -put /input.txt /</span><br></pre></td></tr></table></figure>
<p>执行wordcount任务</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> bin/hadoop jar wordcount.jar WordCount /input.txt /user/joe/wordcount/output</span><br></pre></td></tr></table></figure>
<hr>
<p>欢迎关注公众号：「努力给自己看」</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNbRwly1fxr3rttfbgj308c08b3zp.jpg" alt="扫码"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="default">
    <link itemprop="mainEntityOfPage" href="https://caixiaobai.github.io/2018/12/01/hexo博客更换主题/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KeepUp">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KeepUp's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/01/hexo博客更换主题/" class="post-title-link" itemprop="url">hexo博客更换主题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-12-01 11:09:16" itemprop="dateCreated datePublished" datetime="2018-12-01T11:09:16+08:00">2018-12-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-11-16 15:11:12" itemprop="dateModified" datetime="2019-11-16T15:11:12+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/博客搭建/" itemprop="url" rel="index"><span itemprop="name">博客搭建</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>前边我们已经学会了博客的搭建了，这次我们来看看怎么样让我们的博客更漂亮，更个性化。那就是来更换博客的主题，让我们的博客与众不同起来。我们可以去<a href="https://hexo.io/themes/" target="_blank" rel="noopener">hexo的主题官网</a>去挑选你自己喜欢的主题风格。里边收录了很多牛人自己写的漂亮的主题。</p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g8zwdxiwhrj31h70u0wk5.jpg" alt="image-20181201111813173"></p>
<p>选择一个你喜欢的主题，每个主题都在GitHub上面开源的代码。下边以我自己选择的<a href="https://github.com/Sariay/hexo-theme-Annie" target="_blank" rel="noopener">Annie主题</a>为例来介绍一下。</p>
<h4 id="下载和切换主题"><a href="#下载和切换主题" class="headerlink" title="下载和切换主题"></a>下载和切换主题</h4><p>首先我们进入到你的本地博客目录下的themes目录下，克隆你选择的主题的GitHub仓库到本地。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git clone https://github.com/Sariay/hexo-theme-Annie.git</span><br></pre></td></tr></table></figure>
<p>下载完成后你就可以看到，hexo-theme-Annie就是你新克隆下来的主题</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ls</span><br><span class="line">hexo-theme-Annie landscape</span><br></pre></td></tr></table></figure>
<p>然后修改你博客根目录下的_config.yml文件里的theme配置来更换使用的主题</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Extensions</span><br><span class="line">## Plugins: https://hexo.io/plugins/</span><br><span class="line">## Themes: https://hexo.io/themes/</span><br><span class="line">theme: hexo-theme-Annie</span><br></pre></td></tr></table></figure>
<h4 id="Annie主题的使用"><a href="#Annie主题的使用" class="headerlink" title="Annie主题的使用"></a>Annie主题的使用</h4><p>这里我就不做过多的介绍了，因为主题的作者博客里的文档写得非常详细了。</p>
<p><a href="https://sariay.github.io/2018/08/27/Annie%E4%B8%BB%E9%A2%98%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/" target="_blank" rel="noopener">Annie主题使用说明</a></p>
<p><a href="https://sariay.github.io/2018/11/18/Annie%E4%B8%BB%E9%A2%98%E4%BD%BF%E7%94%A8Gitalk/" target="_blank" rel="noopener">Annie主题使用Gitalk</a></p>
<h4 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h4><p>GitHub的主题wiki里都要详细的安装说明，根据你自己选择的主题的文档安装即可。</p>
<hr>
<h4 id="推荐阅读"><a href="#推荐阅读" class="headerlink" title="推荐阅读"></a>推荐阅读</h4><p><a href="https://caixiaobai.github.io/2018/11/17/hexo-github搭建个人博客/">hexo+github搭建个人博客</a></p>
<hr>
<p>欢迎关注公众号：「努力给自己看」</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNbRwly1fxr3rttfbgj308c08b3zp.jpg" alt="扫码"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">KeepUp</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">37</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">37</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">KeepUp</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/muse.js"></script>
<script src="/js/next-boot.js"></script>



  















  

  

</body>
</html>
